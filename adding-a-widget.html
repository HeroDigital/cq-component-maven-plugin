
<!DOCTYPE html>
<!--
 Generated by Apache Maven Doxia at Jul 25, 2013
 Rendered using Maven Reflow Skin 1.0.0 (http://andriusvelykis.github.com/reflow-maven-skin)
-->
<html  xml:lang="en" lang="en">

	<head>
		<meta charset="UTF-8" />
		<title>Adding a Widget | CQ Component Plugin</title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<meta name="description" content="" />
		<meta http-equiv="content-language" content="en" />

		<link href="./css/bootstrap.min.css" rel="stylesheet" />
		<link href="./css/bootstrap-responsive.min.css" rel="stylesheet" />
		<link href="./css/docs.css" rel="stylesheet" />
		<link href="./css/reflow-skin.css" rel="stylesheet" />
		
		<link href="http://yandex.st/highlightjs/7.3/styles/github.min.css" rel="stylesheet" />
		
		<link href="./css/lightbox.css" rel="stylesheet" />
		
		<link href="./css/site.css" rel="stylesheet" />
		<link href="./css/print.css" rel="stylesheet" media="print" />
		
		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
			<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->

		<!-- Google Analytics -->
		<script type="text/javascript">
		
			var _gaq = _gaq || [];
			_gaq.push(['_setAccount', 'UA-928005-4']);
			_gaq.push(['_trackPageview']);

			(function() {
				var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
				ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
				var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
			})();

		</script>
		</head>

	<body class="page-adding-a-widget project-cq-component-plugin" data-spy="scroll" data-offset="60" data-target="#toc-scroll-target">

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="index.html">CQ Component Plugin</a>
					<div class="nav-collapse">
						<ul class="nav pull-right">
							<li><a href="https://github.com/Citytechinc/cq-component-maven-plugin/" title="GitHub" class="externalLink">GitHub </a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Basics <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li><a href="configuration.html" title="Configuration">Configuration </a></li>
									<li><a href="usage.html" title="Usage">Usage </a></li>
								</ul>
							</li>
							<li class="dropdown active">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Extending <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="active"><a href="" title="Adding a Widget">Adding a Widget </a></li>
									<li><a href="adding-a-transformer.html" title="Adding a Transformer">Adding a Transformer </a></li>
								</ul>
							</li>
						</ul>
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>
		
	<div class="container">
	
	<!-- Masthead
	================================================== -->
	<header class="jumbotron subhead">
		<div class="row" id="banner">
			<div class="span12">
				<div class="pull-left">
					<a href="http://www.citytechinc.com" id="bannerLeft"><img src="img/logo.png" alt='"''"' /></a>
				</div>
				<div class="pull-right">
					<a href="index.html" id="bannerRight"><h1>CQ Component Plugin</h1></a>
					<p class="lead">A Plugin for CQ Components!</p>
				</div>
			</div>
		</div>
	</header>

	<div class="main-body">
	<div class="row">
		<div class="span8">
			<div class="body-content">
<div class="section"> 
 <div class="page-header">
  <h2 id="Adding_a_Widget">Adding a Widget</h2>
 </div> 
 <p>If you have a custom xtype that you would like to add as a annotation (or an out of box one that wasnt included by default), the component plugin allows for this via the addition of a few classes and an annotation. </p> 
 <div class="section"> 
  <h3 id="Extending_WidgetParameters">Extending WidgetParameters</h3> 
  <p>The class <a href="apidocs/com/citytechinc/cq/component/dialog/widget/WidgetParameters.html">WidgetParameters</a> is used to pass all the parameters needed to build the widget from the WidgetMaker to the implementing widget class. If the widget requires no extra configuration, this class can be used directly, otherwise it must be extended and the additional fields and accessors for the widget properties must be added.</p> 
  <div class="section"> 
   <h4 id="Example_For_CQExtformCheckbox">Example (For CQ.Ext.form.Checkbox):</h4> 
   <div class="source"> 
    <pre>import com.citytechinc.cq.component.dialog.widget.WidgetParameters;
import com.citytechinc.cq.component.util.Constants;

public class CheckBoxWidgetParameters extends WidgetParameters {
    private String inputValue;
    private boolean checked;

    public String getInputValue() {
       return inputValue;
    }

    public void setInputValue(String inputValue) {
       this.inputValue = inputValue;
    }

    public boolean isChecked() {
       return checked;
    }

    public void setChecked(boolean checked) {
       this.checked = checked;
    }
}
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Adding_the_Widget_Class">Adding the Widget Class</h3> 
  <p>The abstract class <a href="apidocs/com/citytechinc/cq/component/dialog/AbstractWidget.html">AbstractWidget</a> is used as a superclass for all widgets and builds the base component properties based on the WidgetParameters passed in. This class must be extended and all fields that will end up in the dialog.xml need to have getters created.</p> 
  <div class="section"> 
   <h4 id="Example_For_CQExtformCheckbox">Example (For CQ.Ext.form.Checkbox):</h4> 
   <div class="source"> 
    <pre>import com.citytechinc.cq.component.dialog.AbstractWidget;

public class CheckBoxWidget extends AbstractWidget {

    private final String inputValue;
    private final boolean checked;

    public CheckBoxWidget(CheckBoxWidgetParameters parameters) {
       super(parameters);
       this.inputValue = parameters.getInputValue();
       this.checked = parameters.isChecked();
    }

    public String getInputValue() {
       return inputValue;
    }

    public boolean isChecked() {
       return checked;
    }
}
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Adding_a_Maker">Adding a Maker</h3> 
  <p>The next step is to add a maker class that extends <a href="apidocs/com/citytechinc/cq/component/dialog/maker/AbstractWidgetMaker.html">AbstractWidgetMaker</a>. This class provides some utility methods to get the field name, field label, and other commonly used parameters. It also provides access to all the annotations that are on the field/method by using the getAnnotation method.</p> 
  <p>When extending AbstractWidgetMaker, the make class must be implemented and must return the build widget class.</p> 
  <div class="section"> 
   <h4 id="Example_For_CQExtformCheckbox">Example (For CQ.Ext.form.Checkbox):</h4> 
   <div class="source"> 
    <pre>import java.util.Map;

import com.citytechinc.cq.component.annotations.widgets.CheckBox;
import com.citytechinc.cq.component.dialog.DialogElement;
import com.citytechinc.cq.component.dialog.Listeners;
import com.citytechinc.cq.component.dialog.maker.AbstractWidgetMaker;
import com.citytechinc.cq.component.dialog.maker.WidgetMakerParameters;

public class CheckBoxWidgetMaker extends AbstractWidgetMaker {

    public CheckBoxWidgetMaker(WidgetMakerParameters parameters) {
       super(parameters);
    }

    public DialogElement make() throws ClassNotFoundException {

       CheckBox checkBoxAnnotation = getAnnotation(CheckBox.class);

       String name = getNameForField();
       String fieldName = getFieldNameForField();
       String fieldLabel = getFieldLabelForField();
       String fieldDescription = getFieldDescriptionForField();
       Boolean isRequired = getIsRequiredForField();
       Map&lt;String, String&gt; additionalProperties = getAdditionalPropertiesForField();
       String defaultValue = getDefaultValueForField();
       boolean hideLabel = getHideLabelForField();

       String inputValue = getInputValueForField(checkBoxAnnotation);
       boolean checked = getCheckedForField(checkBoxAnnotation);

       Listeners listeners = getListeners();

       CheckBoxWidgetParameters widgetParameters = new CheckBoxWidgetParameters();
       widgetParameters.setInputValue(inputValue);
       widgetParameters.setChecked(checked);
       widgetParameters.setFieldLabel(fieldLabel);
       widgetParameters.setFieldDescription(fieldDescription);
       widgetParameters.setAllowBlank(!isRequired);
       widgetParameters.setHideLabel(hideLabel);
       widgetParameters.setDefaultValue(defaultValue);
       widgetParameters.setName(name);
       widgetParameters.setFieldName(fieldName);
       widgetParameters.setAdditionalProperties(additionalProperties);
       widgetParameters.setListeners(listeners);

       return new CheckBoxWidget(widgetParameters);

    }

    protected String getInputValueForField(CheckBox annotation) {
       return annotation.inputValue();
    }

    protected boolean getCheckedForField(CheckBox annotation) {
       return annotation.checked();
    }

}
</pre> 
   </div> 
  </div> 
 </div> 
 <div class="section"> 
  <h3 id="Adding_the_Widget_Annotation">Adding the Widget Annotation</h3> 
  <p>All widgets are found by the plugin by scanning all dependencies for the <a href="apidocs/com/citytechinc/cq/component/annotations/config/Widget.html">Widget</a> annotations, so we must add this to the widget class. The annotation requires that you configure the widget annotation class, the widget maker, and the xtype for the widget.</p> 
  <div class="section"> 
   <h4 id="Example_For_CQExtformCheckbox">Example (For CQ.Ext.form.Checkbox):</h4> 
   <div class="source"> 
    <pre>...
import com.citytechinc.cq.component.dialog.AbstractWidget;

@Widget(annotationClass = CheckBox.class, makerClass = CheckBoxWidgetMaker.class, xtype = &quot;checkbox&quot;)
public class CheckBoxWidget extends AbstractWidget {

    private final String inputValue;
    ...
}
</pre> 
   </div> 
  </div> 
 </div> 
</div>
			</div>
		</div>
		<div class="span4">
			<div id="toc-sidebar">
				<div class="well">
					<ul class="nav nav-list">
						<li class="nav-header">Table of Contents</li>
		<li class="dropdown"><a href="#Adding_a_Widget" title="Adding a Widget">Adding a Widget <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li class="dropdown"><a href="#Extending_WidgetParameters" title="Extending WidgetParameters">Extending WidgetParameters <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Example_For_CQExtformCheckbox" title="Example (For CQ.Ext.form.Checkbox):">Example (For CQ.Ext.form.Checkbox):</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Adding_the_Widget_Class" title="Adding the Widget Class">Adding the Widget Class <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Example_For_CQExtformCheckbox" title="Example (For CQ.Ext.form.Checkbox):">Example (For CQ.Ext.form.Checkbox):</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Adding_a_Maker" title="Adding a Maker">Adding a Maker <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Example_For_CQExtformCheckbox" title="Example (For CQ.Ext.form.Checkbox):">Example (For CQ.Ext.form.Checkbox):</a>
				<li class="divider"></li>
			</ul>
		</li>
		<li class="dropdown"><a href="#Adding_the_Widget_Annotation" title="Adding the Widget Annotation">Adding the Widget Annotation <b class="caret"></b></a>
			<ul class="nav nav-list">
		<li><a href="#Example_For_CQExtformCheckbox" title="Example (For CQ.Ext.form.Checkbox):">Example (For CQ.Ext.form.Checkbox):</a>
				<li class="divider"></li>
			</ul>
		</li>
			</ul>
		</li>
					</ul>
				</div>
			</div>
		</div>
	</div>
	</div>

	</div><!-- /container -->
	
	<!-- Footer
	================================================== -->
	<footer class="well">
		<div class="container">
			<div class="row">
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Main</li>
						<li>
							<a href="index.html" title="Home">Home </a>
						</li>
						<li>
							<a href="https://github.com/Citytechinc/cq-component-maven-plugin/" title="GitHub" class="externalLink">GitHub </a>
						</li>
						<li>
							<a href="apidocs/index.html" title="Java Doc">Java Doc </a>
						</li>
						<li>
							<a href="http://www.citytechinc.com" title="CITYTECH Inc." class="externalLink">CITYTECH Inc. </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Basics</li>
						<li>
							<a href="configuration.html" title="Configuration">Configuration </a>
						</li>
						<li>
							<a href="usage.html" title="Usage">Usage </a>
						</li>
					</ul>
				</div>
				<div class="span3 bottom-nav">
					<ul class="nav nav-list">
						<li class="nav-header">Extending</li>
						<li class="active">
							<a href="#" title="Adding a Widget">Adding a Widget </a>
						</li>
						<li>
							<a href="adding-a-transformer.html" title="Adding a Transformer">Adding a Transformer </a>
						</li>
					</ul>
				</div>
			</div>
		</div>
	</footer>
		
	<div class="container subfooter">
		<div class="row">
			<div class="span12">
				<p class="pull-right"><a href="#">Back to top</a></p>
				<p class="copyright">Copyright &copy;2013. All Rights Reserved.</p>
				<p class="version-date"><span class="projectVersion">Version: 2.0.0-SNAPSHOT. </span><span class="publishDate">Last Published: 2013-07-25. </span></p>
					</div>
		</div>
	</div>

	<!-- Le javascript
	================================================== -->
	<!-- Placed at the end of the document so the pages load faster -->

	<!-- Fallback jQuery loading from Google CDN:
	     http://stackoverflow.com/questions/1014203/best-way-to-use-googles-hosted-jquery-but-fall-back-to-my-hosted-library-on-go -->
	<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.3/jquery.min.js"></script>
	<script type="text/javascript">
		if (typeof jQuery == 'undefined')
		{
			document.write(unescape("%3Cscript src='./js/jquery-1.8.3.min.js' type='text/javascript'%3E%3C/script%3E"));
		}
	</script>
	
	<script src="./js/bootstrap.min.js"></script>
	<script src="./js/lightbox.js"></script>
	<script src="./js/jquery.smooth-scroll.min.js"></script>
	<!-- back button support for smooth scroll -->
	<script src="./js/jquery.ba-bbq.min.js"></script>
	<script src="http://yandex.st/highlightjs/7.3/highlight.min.js"></script>

	<script src="./js/reflow-skin.js"></script>
	
	</body>
</html>
